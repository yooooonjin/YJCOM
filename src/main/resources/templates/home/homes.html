<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
	<head>
		<th:block th:insert="/common/common.html::head" />
		<link rel="stylesheet" href="/css/common/header-nav.css">
		<link rel="stylesheet" href="/css/home/homes.css">
		
	</head>
	<body>
		<header>
			<section id="header">
				<div class="flex between view">
					<div class="logo">
						<a href="/"><img src="/image/airbnb_logo-w.png" width=120px></a>
					</div>
					<div class="search">
						<div class="flex search-detail">
							<div><input type="text" placeholder="위치"></div>
							<div><input type="date" placeholder="체크인"></div>
							<div><input type="date" placeholder="체크아웃"></div>
							<div>
								<input type="text" placeholder="인원">
								<a><img src="/image/search-01.png" width="30px"></a>
							</div>
						</div>
					</div>
					<th:block th:insert="/common/header-nav.html::header-nav"/>
				</div>
			</section>
			
			<section id="filter-menu">
				<div class="flex view">
					<div class="flex">
						<ul class="flex">
							<li><button class="price-range">요금</button></li>
							<li><button class="room-type">숙소유형</button></li>
						</ul>
						<ul class="filter flex">
							<li><button>주방</button></li>
							<li><button>무선인터넷</button></li>
							<li><button>세탁기</button></li>
						</ul>
					</div>
				</div>
			</section>
		</header>
		
		<main class="flex between">
			<section id="home-list">
				<h1>집정보</h1>
				<div class="home-list" th:each="homes:${homes}">
				<input type="hidden" id="homeAddress" th:value="${homes.homeAddress}">
					<div class="flex between">
						<div><img src="/image/room-img-01.jpg" width="300px" height="200px"></div>
						<div class="home-info">
							<div>
								<ul>
									<li class="home-type">[[${homes.homeType.homeType}]]</li>
									<li class="home-name"><a th:href="|/home/detail/${homes.hno}|">[[${homes.homeName}]]</a></li>
									<li class="home-number">
										<div class="flex">
											<div>최대인원 <span>[[${homes.maximumNumber}]]</span>명</div>
											<div>침대 <span>[[${homes.bedNumber}]]</span>개</div>
											<div>침실 <span>[[${homes.bedroomNumber}]]</span>개</div>
											<div>욕실 <span>[[${homes.bathroomNumber}]]</span>개</div>
										</div>
									</li>
									<li class="home-filter">
										<span th:each="ho : ${homes.homeOptionSet}">[[${ho.homeOption}]]</span>
									</li>
								</ul>
								<ul class="home-price">
									<li>[[${homes.homePrice}]]원&nbsp;<span>/박</span></li>
								</ul>
							</div>
						</div>
						<div class="home-comment">
							<ul class="flex end">
								<li>별점</li>
								<li>(후기)</li>
							</ul>
						</div>
					</div>
				</div>
			</section>
			
			<section>
				<div id="map" style="width:100vh;height:100vh;"></div>
			</section>
			<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=44c331bb2848d75067011ce7a893d31f&libraries=services"></script>
			<script type="text/javascript">
			
			var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
		    mapOption = {
		        center: new kakao.maps.LatLng(37.6568255, 127.021725), // 지도의 중심좌표
		        level: 3 // 지도의 확대 레벨
		    };  

			// 지도를 생성합니다    
			var map = new kakao.maps.Map(mapContainer, mapOption); 
	
			
			
			
			

			// 마커를 표시할 위치와 내용을 가지고 있는 객체 배열입니다 
			var positions = [
			    {
			        content: '<div>윤진집</div>', 
			        latlng: new kakao.maps.LatLng(37.6568255, 127.021725)
			    },
			    {
			        content: '<div>그린컴</div>', 
			        latlng: new kakao.maps.LatLng(37.6571989, 127.062251)
			    },
			];
			
			var homeAddress="[[${homes.homeAddress}]]"
			
			homeAddress.forEach(function(){
				
				var geocoder = new kakao.maps.services.Geocoder();

				// 주소로 좌표를 검색합니다
				geocoder.addressSearch(homeAddress, function(result, status) {

				    // 정상적으로 검색이 완료됐으면 
				     if (status === kakao.maps.services.Status.OK) {

				        var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

				        // 결과값으로 받은 위치를 마커로 표시합니다
				        var marker = new kakao.maps.Marker({
				            map: map,
				            position: coords
				        });

				        // 인포윈도우로 장소에 대한 설명을 표시합니다
				        var infowindow = new kakao.maps.InfoWindow({
				            content: '<div style="width:150px;text-align:center;padding:6px 0;">우리회사</div>'
				        });
				        infowindow.open(map, marker);

				        // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
				        map.setCenter(coords);
				    } 
				});    
				
				
				
				
				positions.push(result);
			});
			
			
			
	
			for (var i = 0; i < positions.length; i ++) {
			    // 마커를 생성합니다
			    var marker = new kakao.maps.Marker({
			        map: map, // 마커를 표시할 지도
			        position: positions[i].latlng // 마커의 위치
			    });
	
			    // 마커에 표시할 인포윈도우를 생성합니다 
			    var infowindow = new kakao.maps.InfoWindow({
			        content: positions[i].content // 인포윈도우에 표시할 내용
			    });
	
			    // 마커에 mouseover 이벤트와 mouseout 이벤트를 등록합니다
			    // 이벤트 리스너로는 클로저를 만들어 등록합니다 
			    // for문에서 클로저를 만들어 주지 않으면 마지막 마커에만 이벤트가 등록됩니다
			    kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
			    kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
			}
	
			// 인포윈도우를 표시하는 클로저를 만드는 함수입니다 
			function makeOverListener(map, marker, infowindow) {
			    return function() {
			        infowindow.open(map, marker);
			    };
			}
	
			// 인포윈도우를 닫는 클로저를 만드는 함수입니다 
			function makeOutListener(infowindow) {
			    return function() {
			        infowindow.close();
			    };
			}
			
		
			</script>
			
		</main>
	</body>
</html>